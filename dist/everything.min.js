var gameLogic;!function(a){function b(a,b){return angular.equals(a,b)}function c(a){return angular.copy(a)}function d(){var a,b,c=[];for(a=0;10>a;a+=1)for(c[a]=[],b=0;10>b;b+=1)c[a][b]="";return c[0][3]="A",c[0][6]="A",c[3][0]="A",c[3][9]="A",c[6][0]="B",c[6][9]="B",c[9][3]="B",c[9][6]="B",c}function e(){var a=d();return{turnInfo:{ctr:2,pawn:"A"},pawnDelta:{row:"",col:""},board:a}}function f(a,b,c){var d,e,f={rowFrom:0,rowTo:0,colFrom:0,colTo:0};for(f=0===a&&0===b?{rowFrom:0,rowTo:1,colFrom:0,colTo:1}:0===a&&9===b?{rowFrom:0,rowTo:1,colFrom:8,colTo:9}:9===a&&0===b?{rowFrom:8,rowTo:9,colFrom:0,colTo:1}:9===a&&9===b?{rowFrom:8,rowTo:9,colFrom:8,colTo:9}:0===a&&b>0&&9>b?{rowFrom:0,rowTo:1,colFrom:b-1,colTo:b+1}:a>0&&9>a&&0===b?{rowFrom:a-1,rowTo:a+1,colFrom:0,colTo:1}:9===a&&b>0&&9>b?{rowFrom:8,rowTo:9,colFrom:b-1,colTo:b+1}:a>0&&9>a&&9===b?{rowFrom:a-1,rowTo:a+1,colFrom:8,colTo:9}:{rowFrom:a-1,rowTo:a+1,colFrom:b-1,colTo:b+1},d=f.rowFrom;d<=f.rowTo;d+=1)for(e=f.colFrom;e<=f.colTo;e+=1)if(""===c[d][e])return 1;return 0}function g(a,b){var c,d,e=0,g=0;for(c=0;10>c;c+=1)for(d=0;10>d;d+=1)"A"===a[c][d]?e+=f(c,d,a):"B"===a[c][d]&&(g+=f(c,d,a));return"A"===b&&0===g?"A":"B"===b&&0===e?"B":""}function h(a,b,d,f){if("{}"===f)f=e();else{var h=angular.fromJson(f);f=h}0===d&&(d={turnIndex:0}),1===d&&(d={turnIndex:1});var i,j,k=f.board,l=f.turnInfo,m=d,n=l,o=a,p=b,q=c(k);if(""!==k[b.row][b.col])throw new Error("pawn must land in empty position");if(2===l.ctr){if(k[a.row][a.col]!==l.pawn)throw new Error("pawn has to exist at position");q[a.row][a.col]=""}if(1===l.ctr){if(a.row!==f.pawnDelta.row||a.col!==f.pawnDelta.col)throw new Error("Wrong position for shooting arrow");if(0===d.turnIndex&&"A"!==k[a.row][a.col]||1===d.turnIndex&&"B"!==k[a.row][a.col])throw new Error("player has to shoot arrow from the same place")}if(q[b.row][b.col]=l.pawn,1===l.ctr){if(i=g(q,q[a.row][a.col]),""!==i){j={endMatch:{endMatchScores:"A"===i?[1,0]:"B"===i?[0,1]:[0,0]}},n={ctr:"",pawn:""};var r="A"===i?"Game Over! White player wins":"Game over! Black Player wins";return window.alert(r),[j,{set:{key:"turnInfo",value:n}},{set:{key:"pawnPosition",value:{row:o.row,col:o.col}}},{set:{key:"pawnDelta",value:{row:p.row,col:p.col}}},{set:{key:"board",value:q}}]}0===d.turnIndex?(m.turnIndex=1,n.ctr=2,n.pawn="B"):1===d.turnIndex&&(m.turnIndex=0,n.ctr=2,n.pawn="A")}else n.ctr=1,n.pawn="X";return[{setTurn:m},{set:{key:"turnInfo",value:n}},{set:{key:"pawnPosition",value:{row:o.row,col:o.col}}},{set:{key:"pawnDelta",value:{row:p.row,col:p.col}}},{set:{key:"board",value:q}}]}function i(a,b,c){var d,e,f;if(0!==Math.abs(a.row-b.row))return!1;if(b.col>a.col){for(e=b,f=a,d=f.col+1;d<=e.col;d+=1)if(""!==c[e.row][d])return!1}else for(e=a,f=b,d=e.col-1;d>=f.col;d-=1)if(""!==c[e.row][d])return!1;return!0}function j(a,b,c){var d,e,f;if(0!==Math.abs(a.col-b.col))return!1;if(b.row>a.row){for(d=b,e=a,f=e.row+1;f<=d.row;f+=1)if(""!==c[f][d.col])return!1}else for(d=a,e=b,f=d.row-1;f>=e.row;f-=1)if(""!==c[f][d.col])return!1;return!0}function k(a,b,c){var d,e,f,g;if(Math.abs(a.row-b.row)!==Math.abs(a.col-b.col))return!1;if(d=b,e=a,b.col>a.col&&b.row<a.row)for(f=e.row-1,g=e.col+1;f>=d.row&&g<=d.col;){if(""!==c[f][g])return!1;f-=1,g+=1}else if(b.col>a.col&&b.row>a.row)for(f=e.row+1,g=e.col+1;f<=d.row&&g<=d.col;){if(""!==c[f][g])return!1;f+=1,g+=1}else if(b.col<a.col&&b.row>a.row)for(f=e.row+1,g=e.col-1;f<=d.row&&g>=d.col;){if(""!==c[f][g])return!1;f+=1,g-=1}else if(b.col<a.col&&b.row<a.row)for(f=e.row-1,g=e.col-1;f>=d.row&&g>=d.col;){if(""!==c[f][g])return!1;f-=1,g-=1}return!0}function l(){var a=[{turnIndexBeforeMove:{turnIndex:0},stateBeforeMove:{turnInfo:{ctr:2,pawn:"A"},pawnDelta:{row:"",col:""},board:[["","","","A","","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","B","","","B","","",""]]},move:[{setTurn:{turnIndex:0}},{set:{key:"turnInfo",value:{ctr:1,pawn:"X"}}},{set:{key:"pawnPosition",value:{row:0,col:3}}},{set:{key:"pawnDelta",value:{row:0,col:4}}},{set:{key:"board",value:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","B","","","B","","",""]]}}],comment:"player 0 starts and moves his pawn from (0,3) to (0,4)"},{turnIndexBeforeMove:{turnIndex:0},stateBeforeMove:{turnInfo:{ctr:1,pawn:"X"},pawnDelta:{row:0,col:4},board:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","B","","","B","","",""]]},move:[{setTurn:{turnIndex:1}},{set:{key:"turnInfo",value:{ctr:2,pawn:"B"}}},{set:{key:"pawnPosition",value:{row:0,col:4}}},{set:{key:"pawnDelta",value:{row:9,col:4}}},{set:{key:"board",value:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","B","X","","B","","",""]]}}],comment:"player 0 shoots arrow from (0,4) to (9,4)"},{turnIndexBeforeMove:{turnIndex:1},stateBeforeMove:{turnInfo:{ctr:2,pawn:"B"},pawnDelta:{row:9,col:4},board:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","B","X","","B","","",""]]},move:[{setTurn:{turnIndex:1}},{set:{key:"turnInfo",value:{ctr:1,pawn:"X"}}},{set:{key:"pawnPosition",value:{row:6,col:0}}},{set:{key:"pawnDelta",value:{row:9,col:0}}},{set:{key:"board",value:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","B","X","","B","","",""]]}}],comment:"player 1 now has the turn and moves his pawn from (6,0) to (9,0)"},{turnIndexBeforeMove:{turnIndex:1},stateBeforeMove:{turnInfo:{ctr:1,pawn:"X"},pawnDelta:{row:9,col:0},board:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","B","X","","B","","",""]]},move:[{setTurn:{turnIndex:0}},{set:{key:"turnInfo",value:{ctr:2,pawn:"A"}}},{set:{key:"pawnPosition",value:{row:9,col:0}}},{set:{key:"pawnDelta",value:{row:4,col:0}}},{set:{key:"board",value:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["X","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","B","X","","B","","",""]]}}],comment:"player 1 shoots arrow from (9,0) to (4,0)"},{turnIndexBeforeMove:{turnIndex:0},stateBeforeMove:{turnInfo:{ctr:2,pawn:"A"},pawnDelta:{row:4,col:0},board:[["","","","","A","","A","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["X","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","B","X","","B","","",""]]},move:[{setTurn:{turnIndex:0}},{set:{key:"turnInfo",value:{ctr:1,pawn:"X"}}},{set:{key:"pawnPosition",value:{row:0,col:6}}},{set:{key:"pawnDelta",value:{row:0,col:9}}},{set:{key:"board",value:[["","","","","A","","","","","A"],["","","","","","","","","",""],["","","","","","","","","",""],["A","","","","","","","","","A"],["X","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","","B"],["","","","","","","","","",""],["","","","","","","","","",""],["B","","","B","X","","B","","",""]]}}],comment:"player 0 moves his pawn from (0,6) to (0,9)"}];return a}function m(){var a=[{turnIndexBeforeMove:{turnIndex:1},stateBeforeMove:{turnInfo:{ctr:2,pawn:"B"},pawnDelta:{row:"0",col:"2"},board:[["","","X","A","X","X","A","X","",""],["","","X","X","","X","X","X","",""],["X","X","","","","","","","X","X"],["A","X","","","","","","","X","A"],["X","X","","","","X","","X","X","X"],["X","X","","","","","","","X","X"],["B","X","","","","","","","X","B"],["X","X","","","","","","","X","X"],["","","X","X","","","","","",""],["","","X","B","X","X","B","","",""]]},move:[{setTurn:{turnIndex:1}},{set:{key:"turnInfo",value:{ctr:1,pawn:"X"}}},{set:{key:"pawnPosition",value:{row:9,col:3}}},{set:{key:"pawnDelta",value:{row:8,col:4}}},{set:{key:"board",value:[["","","X","A","X","X","A","X","",""],["","","X","X","","X","X","X","",""],["X","X","","","","","","","X","X"],["A","X","","","","","","","X","A"],["X","X","","","","X","","X","X","X"],["X","X","","","","","","","X","X"],["B","X","","","","","","","X","B"],["X","X","","","","","","","X","X"],["","","X","X","B","","","","",""],["","","X","","X","X","B","","",""]]}}],comment:"if B plays a combination of pawn move from 9,3 to 8,4 and then arrow move from 8,4 to 1,4 : B wins"},{turnIndexBeforeMove:{turnIndex:0},stateBeforeMove:{turnInfo:{ctr:2,pawn:"A"},pawnDelta:{row:"9",col:"3"},board:[["X","","X","","X","X","A","X","",""],["","","X","X","","X","X","X","",""],["X","X","","","X","","X","","X","X"],["A","","","X","A","","","","X","A"],["X","X","","","","X","","X","X","X"],["X","","","","X","","","","X","X"],["B","X","","","","","B","","X",""],["X","X","","","","","","","X","X"],["","","X","X","","","","","",""],["X","","X","B","X","X","B","","",""]]},move:[{setTurn:{turnIndex:0}},{set:{key:"turnInfo",value:{ctr:1,pawn:"X"}}},{set:{key:"pawnPosition",value:{row:3,col:4}}},{set:{key:"pawnDelta",value:{row:5,col:2}}},{set:{key:"board",value:[["X","","X","","X","X","A","X","",""],["","","X","X","","X","X","X","",""],["X","X","","","X","","X","","X","X"],["A","","","X","","","","","X","A"],["X","X","","","","X","","X","X","X"],["X","","A","","X","","","","X","X"],["B","X","","","","","B","","X",""],["X","X","","","","","","","X","X"],["","","X","X","","","","","",""],["X","","X","B","X","X","B","","",""]]}}],comment:"A moves to 5,2 and can block off pawn B at 6,0 completely by playing his arrow to 5,1"}];return a}function n(a,b){var c=angular.fromJson(a);a=c;var d,e,f,g,i=[],j={1:[],2:[],3:[],4:[]},k=1,l=a.board,m=a.turnInfo;if(2===m.ctr){for(f=0;10>f;f+=1)for(g=0;10>g;g+=1)if(0===b&&"A"===l[f][g]||1===b&&"B"===l[f][g]){var n={row:f,col:g};i.push(n)}}else i.push(a.pawnDelta);for(console.log(i),f=0;f<i.length;f+=1){var o=i[f];for(g=o.col+1;10>g&&""===l[o.row][g];g+=1)c={row:o.row,col:g},j[k].push(c);for(g=o.col-1;g>=0&&""===l[o.row][g];g-=1)c={row:o.row,col:g},j[k].push(c);for(g=o.row+1;10>g&&""===l[g][o.col];g+=1)c={row:g,col:o.col},j[k].push(c);for(g=o.row-1;g>=0&&""===l[g][o.col];g-=1)c={row:g,col:o.col},j[k].push(c);for(var p=o.row+1,q=o.col+1;10>p&&10>q&&""===l[p][q];)c={row:p,col:q},j[k].push(c),p+=1,q+=1;for(p=o.row+1,q=o.col-1;10>p&&q>=0&&""===l[p][q];)c={row:p,col:q},j[k].push(c),p+=1,q-=1;for(p=o.row-1,q=o.col+1;p>=0&&10>q&&""===l[p][q];)c={row:p,col:q},j[k].push(c),p-=1,q+=1;for(p=o.row-1,q=o.col-1;p>=0&&q>=0&&""===l[p][q];)c={row:p,col:q},j[k].push(c),p-=1,q-=1;k+=1}for(var r,s,t,u;;)if(r=2===m.ctr?Math.floor(4*Math.random()+1):1,d=i[r-1],s=j[r].length,0!==s)break;t=Math.floor(Math.random()*s),u=j[r],e=u[t],console.log(d,e);var v=h(d,e,b,a);return v}function o(a){var c,d=a.move,f=a.turnIndexBeforeMove,g=a.stateBeforeMove,l=g.board;f=0===f?{turnIndex:0}:{turnIndex:1},void 0===l&&(g=e(),l=g.board);var m=d[3].set.value,n=d[2].set.value;try{return i(n,m,l)||j(n,m,l)||k(n,m,l)?(c=h(n,m,f,g),b(d,c)?!0:!1):!1}catch(o){return!1}}a.isEqual=b,a.copyObject=c,a.getInitialBoard=d,a.init=e,a.canMove=f,a.getWinner=g,a.createMove=h,a.horizontalMoveCheck=i,a.verticalMoveCheck=j,a.diagonalMoveCheck=k,a.getExampleGame=l,a.getRiddles=m,a.createComputerMove=n,a.isMoveOk=o}(gameLogic||(gameLogic={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).factory("gameLogic",function(){return{isMoveOk:gameLogic.isMoveOk,createMove:gameLogic.createMove,createComputerMove:gameLogic.createComputerMove,getInitialBoard:gameLogic.getInitialBoard,getExampleGame:gameLogic.getExampleGame,getRiddles:gameLogic.getRiddles,horizontalMoveCheck:gameLogic.horizontalMoveCheck,verticalMoveCheck:gameLogic.verticalMoveCheck,diagonalMoveCheck:gameLogic.diagonalMoveCheck}});var game;!function(a){"use strict";function b(){resizeGameAreaService.setWidthToHeight(1),gameService.setGame({gameDeveloperEmail:"hy821@nyu.edu",minNumberOfPlayers:2,maxNumberOfPlayers:2,exampleGame:gameLogic.getExampleGame(),riddles:gameLogic.getRiddles(),isMoveOk:gameLogic.isMoveOk,updateUI:j}),dragAndDropService.addDragListener("gameArea",c)}function c(b,c,h){a.gameArea=document.getElementById("gameArea");var i=c-a.gameArea.offsetLeft,j=h-a.gameArea.offsetTop,k=a.typeExpected;if(0>i||0>j||i>=a.gameArea.clientWidth||j>=a.gameArea.clientHeight){if(!a.draggingPiece)return;var l=e();d({top:j-l.height/2,left:i-l.width/2},k),"touchend"===b&&"X"===k&&(a.draggingPiece.style.display="none")}else{var m=Math.floor(a.NUM*i/a.gameArea.clientWidth),n=Math.floor(a.NUM*j/a.gameArea.clientHeight);if("touchstart"!==b||a.draggingStartedRowCol||(a.board[n][m]===k&&a.isYourTurn&&"X"!==k?(a.draggingStartedRowCol={row:n,col:m},a.draggingPiece=document.getElementById("piece"+k+"_"+n+"x"+m),a.draggingPiece.style["z-index"]=++a.nextZIndex):a.isYourTurn&&"X"===k&&(a.draggingStartedRowCol=a.pawnDelta,a.draggingPiece=document.getElementById("pieceX_drag"),d(f(n,m),k),a.draggingPiece.style["z-index"]=++a.nextZIndex,a.draggingPiece.style.display="inline")),!a.draggingPiece)return;if("touchend"===b){var o=a.draggingStartedRowCol,p={row:n,col:m};g(o,p)}else d(f(n,m),k)}("touchend"===b||"touchcancel"===b||"touchleave"===b)&&(d(f(a.draggingStartedRowCol.row,a.draggingStartedRowCol.col),k),k===a.typeExpected&&"X"===a.typeExpected&&(a.draggingPiece.style.display="none"),a.draggingStartedRowCol=null,a.draggingPiece=null)}function d(b,c){var d;"X"===c?(d=f(0,0),a.draggingPiece.style.left=b.left-d.left+"px",a.draggingPiece.style.top=b.top-d.top+"px"):(d=f(a.draggingStartedRowCol.row,a.draggingStartedRowCol.col),a.draggingPiece.style.left=b.left-d.left+"px",a.draggingPiece.style.top=b.top-d.top+"px")}function e(){return{width:a.gameArea.clientWidth/a.NUM,height:a.gameArea.clientHeight/a.NUM}}function f(a,b){var c=e();return{top:a*c.height,left:b*c.width}}function g(b,c){$rootScope.$apply(function(){"Dragged piece "+b.row+"x"+b.col+" to square "+c.row+"x"+c.col;if(a.isYourTurn)try{if(gameLogic.horizontalMoveCheck(b,c,a.board)||gameLogic.verticalMoveCheck(b,c,a.board)||gameLogic.diagonalMoveCheck(b,c,a.board)){var d=gameLogic.createMove(b,c,a.turnIndex,a.jsonState);a.lastSelected={row:c.row,col:c.col},gameService.makeMove(d),a.isYourTurn=!1,a.pawnDelta=c,"X"===a.typeExpected&&(a.draggingPiece.style.display="none")}}catch(e){}})}function h(a){for(var b=[],c=0;a>c;c++)b.push(c);return b}function i(){gameService.makeMove(gameLogic.createComputerMove(a.jsonState,a.turnIndex))}function j(b){a.jsonState=angular.toJson(b.stateAfterMove,!0),a.board=b.stateAfterMove.board,a.typeExpected=b.move&&b.move[1]&&b.move[1].set&&b.move[1].set.value?b.move[1].set.value.pawn:"A",void 0===a.board&&(a.board=gameLogic.getInitialBoard()),a.isYourTurn=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove&&null===b.endMatchScores,a.turnIndex=b.turnIndexAfterMove,a.isYourTurn&&""===b.playersInfo[b.yourPlayerIndex].playerId&&(a.isYourTurn=!1,$timeout(i,1e3))}a.NUM=10,a.draggingStartedRowCol=null,a.draggingPiece=null,a.nextZIndex=61,a.board=void 0,a.init=b,a.handleDragEvent=c,a.setDraggingPieceTopLeft=d,a.getSquareWidthHeight=e,a.getSquareTopLeft=f,a.dragDone=g,a.getIntegersTill=h,a.rows=h(a.NUM),a.cols=h(a.NUM),a.rowsNum=a.NUM,a.colsNum=a.NUM,a.pawnDelta={row:"",col:""},a.lastSelected={row:"",col:""},a.sendComputerMove=i,a.isPawn=function(b,c,d){return a.board[b][c]===d?!0:void 0},a.isNotPawn=function(b,c){return"A"===a.board[b][c]||"B"===a.board[b][c]||"X"===a.board[b][c]?!1:!0},a.isWTurn=function(){return 0===a.turnIndex?!0:!1},a.isSelected=function(b,c){return b===a.lastSelected.row&&c===a.lastSelected.col?!0:!1},a.isBTurn=function(){return 1===a.turnIndex?!0:!1},a.updateUI=j}(game||(game={})),angular.module("myApp").run(function(){$rootScope.game=game,translate.setLanguage("en",{AMAZONS_GAME:"Game of the Amazons",RULES_OF_AMAZONS:"Rules of Amazons",RULES_SLIDE0:"Each player has four amazons, and a supply of arrows. White moves first, and the players alternate moves thereafter.",RULES_SLIDE1:"1. Move one amazon one or more empty squares in a straight line (orthogonally or diagonally).",RULES_SLIDE2:"2. The amazon shoots an arrow from its landing square to another square, using another queenlike move.",RULES_SLIDE3:"An arrow and an amazon cannot cross or enter a square where another arrow or an amazon of either color occupies.",RULES_SLIDE4:"When you play, try to block the other player. The last player to be able to make a move wins.",CLOSE:"Start Game"}),game.init()});
//# sourceMappingURL=everything.min.js.map